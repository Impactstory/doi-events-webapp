<div class="page cite-page">

    <div class="content">
        <div class="loading"
             ng-show="apiResp=='loading'">
            <span class="label">Finding metrics &hellip;</span>
            <md-progress-linear md-mode="indeterminate"></md-progress-linear>
        </div>


        <div class="citation animated fadeIn" ng-show="apiResp.doi">
            <h1>{{ apiResp.metadata.title }}</h1>
            <div class="metadata">
                <div class="first-row">
                    <span class="year">{{ apiResp.open_access.year }}</span>
                    <span class="author" ng-repeat="author in apiResp.metadata.author">
                        {{ author.family }}</span>.
                    <span class="journal">{{ apiResp.metadata["container-title"] }}</span>
                    <a href="https://doi.org/{{ apiResp.doi }}" class="linkout">(view)</a>
                </div>
                <div class="second-row">
{#                    <md-button class="md-raised" href="{{ apiResp.open_access.best_oa_location.url }}" target="_blank">#}
                        <i class="fa fa-unlock-alt"></i>
                        Read paper
                    </md-button>
                    <md-button class="md-raised" href="" ng-click="getAlerts()">
                        <i class="fa fa-envelope-o"></i>
                        Get alerts
                    </md-button>
                    <md-button class="md-raised" href="{{ apiUrl }}" target="_blank">
                        <i class="fa fa-cogs"></i>
                        View in API
                    </md-button>

                </div>

            </div>
            <div class="metrics">
                <div class="sources">
                    <div class="source" ng-repeat="source in apiResp.altmetrics.sources"
                            ng-click="p.selectedSource = source">
                        <span class="name">{{ source.source_id }}: </span>
                        <span class="count">{{ source.events_count }}</span>
                    </div>
                </div>
                <div class="events">
                    <h2>
                        <span class="val">{{ filteredSources.length }}</span>
                        {{ p.selectedSource.source_id }} events
                        <span class="remove" ng-show="p.selectedSource" ng-click="p.selectedSource=null">show all events</span>
                    </h2>
                    <div class="event" ng-repeat="event in events | orderBy: '-occurred_at' | filter: {source_id: p.selectedSource.source_id} as filteredSources">
                        <div class="first-row">
                            <a href="{{ event.url }}" class="link">{{ event.url | limitTo: 50 }}...</a>
                        </div>
                        <div class="second-row">
                            <span class="date">{{ event.occurred_ago }}</span>
                        </div>
                    </div>
                </div>
            </div>


        </div>



    </div>

</div>